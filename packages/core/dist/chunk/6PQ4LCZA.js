import { createContext, useContext, createMemo, createSignal, createEffect, onCleanup, mergeProps } from 'solid-js';
import { template, isServer, createComponent, effect, setAttribute } from 'solid-js/web';

var l=createContext();function O(){let o=useContext(l);if(o===void 0)throw new Error("[kobalte]: `useColorMode` must be used within a `ColorModeProvider`");return o}function G(o,e){let{colorMode:t}=O();return createMemo(()=>t()==="dark"?e:o)}var s="kb-color-mode";function $(o){return {ssr:!1,type:"localStorage",get:e=>{if(isServer)return e;let t;try{t=localStorage.getItem(o);}catch{}return t??e},set:e=>{try{localStorage.setItem(o,e);}catch{}}}}var f=$(s);function M(o,e){return o.match(new RegExp(`(^| )${e}=([^;]+)`))?.[2]}function p(o,e){return {ssr:!!e,type:"cookie",get:t=>e?M(e,o)??t:isServer?t:M(document.cookie,o)??t,set:t=>{document.cookie=`${o}=${t}; max-age=31536000; path=/`;}}}var N=p(s);function Q(o){return p(s,o)}var d="system";function h(){return window.matchMedia("(prefers-color-scheme: dark)")}function A(){let o=document.createElement("style");return o.appendChild(document.createTextNode("*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(o),()=>{window.getComputedStyle(document.body),requestAnimationFrame(()=>{requestAnimationFrame(()=>{document.head.removeChild(o);});});}}function S(o,e=!0){let t=e?A():void 0;document.documentElement.dataset.kbTheme=o,document.documentElement.style.colorScheme=o,t?.();}function u(o){return h().matches??o==="dark"?"dark":"light"}function y(o){let e="light",t=o.get(e)??e;return t==="system"?isServer?e:u():t}function x(o){let e=h(),t=r=>{o(r.matches?"dark":"light");};return e.addEventListener("change",t),()=>{e.removeEventListener("change",t);}}function ro(o){let e=()=>o.initialColorMode??d,t=()=>o.storageManager??f,r,[n,a]=createSignal(y(t())),c=i=>{a(i),S(i,o.disableTransitionOnChange);},m=i=>{r&&(r(),r=void 0);let g=i==="system";g&&(r=x(c)),c(g?u():i),t().set(i);},k=()=>{m(n()==="dark"?"light":"dark");};createEffect(()=>{m(t().get()??e());}),onCleanup(()=>{r?.();});let _={colorMode:n,setColorMode:m,toggleColorMode:k};return createComponent(l.Provider,{value:_,get children(){return o.children}})}var V=template('<script id="kb-color-mode-script">'),U=new Set(["light","dark","system"]);function B(o){return U.has(o)?o:d}function uo(o){let e=mergeProps({initialColorMode:d,storageType:"localStorage",storageKey:s},o),t=createMemo(()=>{let r=B(e.initialColorMode),n=`(function(){try{var a=function(o){var l="(prefers-color-scheme: dark)",v=window.matchMedia(l).matches?"dark":"light",e=o==="system"?v:o,d=document.documentElement,s=e==="dark";return d.style.colorScheme=e,d.dataset.kbTheme=e,o},u=a,h="${r}",r="${e.storageKey}",t=document.cookie.match(new RegExp("(^| )".concat(r,"=([^;]+)"))),c=t?t[2]:null;c?a(c):document.cookie="".concat(r,"=").concat(a(h),"; max-age=31536000; path=/")}catch(a){}})();`,a=`(function(){try{var a=function(c){var v="(prefers-color-scheme: dark)",h=window.matchMedia(v).matches?"dark":"light",r=c==="system"?h:c,o=document.documentElement,i=r==="dark";return o.style.colorScheme=r,o.dataset.kbTheme=r,c},n=a,m="${r}",e="${e.storageKey}",t=localStorage.getItem(e);t?a(t):localStorage.setItem(e,a(m))}catch(a){}})();`;return `!${e.storageType==="cookie"?n:a}`.trim()});return (()=>{let r=V();return effect(n=>{let a=e.nonce,c=t();return a!==n._v$&&setAttribute(r,"nonce",n._v$=a),c!==n._v$2&&(r.innerHTML=n._v$2=c),n},{_v$:void 0,_v$2:void 0}),r})()}

export { l as a, O as b, G as c, s as d, $ as e, f, p as g, N as h, Q as i, ro as j, uo as k };
