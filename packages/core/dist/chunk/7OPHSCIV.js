import { a as a$5 } from './GGX2XJIV.js';
import { f as f$2 } from './QRPJCKPG.js';
import { a as a$c } from './VKD4BN57.js';
import { f as f$1 } from './U4KVQHPL.js';
import { a as a$b } from './GDC443NN.js';
import { i, a as a$a, e } from './K4TV2NLR.js';
import { a as a$1 } from './ZMT4QDL4.js';
import { a } from './VRFMVH72.js';
import { a as a$2 } from './FNVJ2A2S.js';
import { a as a$7 } from './B6YIKRNF.js';
import { a as a$3, b } from './UQYWIS72.js';
import { a as a$9 } from './3USQYRTZ.js';
import { d, a as a$6, b as b$1, c } from './63IHFG6C.js';
import { j } from './UAI26547.js';
import { b as b$2 } from './DLDF5P6B.js';
import { a as a$d } from './3LFQJS72.js';
import { a as a$8 } from './BRRMFPGI.js';
import { a as a$4 } from './2B777EKY.js';
import { createContext, useContext, splitProps, Show, createEffect, onCleanup, children, createUniqueId, createSignal, createMemo, on } from 'solid-js';
import { createComponent, mergeProps, memo, Portal } from 'solid-js/web';
import { focusWithoutScrolling, mergeRefs, mergeDefaultProps, callHandler, isFunction, access, isAppleDevice, createGenerateId, contains } from '@kobalte/utils';
import { combineStyle } from '@solid-primitives/props';
import at from 'solid-prevent-scroll';
import Wt from 'solid-presence';

var Q=createContext();function f(){let i=useContext(Q);if(i===void 0)throw new Error("[kobalte]: `useComboboxContext` must be used within a `Combobox` component");return i}function to(i){let s,n=f(),[o,t]=splitProps(i,["ref","style","onCloseAutoFocus","onFocusOutside"]),p=()=>{n.resetInputValue(n.listState().selectionManager().selectedKeys()),n.close(),setTimeout(()=>{n.close();});},m=c=>{o.onFocusOutside?.(c),n.isOpen()&&n.isModal()&&c.preventDefault();};return a({isDisabled:()=>!(n.isOpen()&&n.isModal()),targets:()=>{let c=[];s&&c.push(s);let g=n.controlRef();return g&&c.push(g),c}}),at({element:()=>s??null,enabled:()=>n.contentPresent()&&n.preventScroll()}),a$1({trapFocus:()=>n.isOpen()&&n.isModal(),onMountAutoFocus:c=>{c.preventDefault();},onUnmountAutoFocus:c=>{o.onCloseAutoFocus?.(c),c.defaultPrevented||(focusWithoutScrolling(n.inputRef()),c.preventDefault());}},()=>s),createComponent(Show,{get when(){return n.contentPresent()},get children(){return createComponent(f$1.Positioner,{get children(){return createComponent(a$2,mergeProps({ref(c){let g=mergeRefs(h=>{n.setContentRef(h),s=h;},o.ref);typeof g=="function"&&g(c);},get disableOutsidePointerEvents(){return memo(()=>!!n.isModal())()&&n.isOpen()},get excludedElements(){return [n.controlRef]},get style(){return combineStyle({"--kb-combobox-content-transform-origin":"var(--kb-popper-content-transform-origin)",position:"relative"},o.style)},onFocusOutside:m,onDismiss:p},()=>n.dataset(),t))}})}})}function po(i){let s,n=d(),o=f(),t=mergeDefaultProps({id:o.generateId("input")},i),[p,m,c]=splitProps(t,["ref","disabled","onClick","onInput","onKeyDown","onFocus","onBlur","onTouchEnd"],a$3),g=()=>o.listState().collection(),h=()=>o.listState().selectionManager(),F=()=>p.disabled||o.isDisabled()||n.isDisabled(),{fieldProps:v}=b(m),I=l=>{callHandler(l,p.onClick),o.triggerMode()==="focus"&&!o.isOpen()&&o.open(!1,"focus");},$=l=>{if(callHandler(l,p.onInput),n.isReadOnly()||F())return;let d=l.target;o.setInputValue(d.value),d.value=o.inputValue()??"",o.isOpen()?g().getSize()<=0&&!o.allowsEmptyCollection()&&o.close():(g().getSize()>0||o.allowsEmptyCollection())&&o.open(!1,"input");},W=l=>{if(callHandler(l,p.onKeyDown),!(n.isReadOnly()||F()))switch(o.isOpen()&&callHandler(l,o.onInputKeyDown),l.key){case"Enter":if(o.isOpen()){l.preventDefault();let d=h().focusedKey();d!=null&&h().select(d);}break;case"Tab":o.isOpen()&&(o.close(),o.resetInputValue(o.listState().selectionManager().selectedKeys()));break;case"Escape":o.isOpen()?(o.close(),o.resetInputValue(o.listState().selectionManager().selectedKeys())):o.setInputValue("");break;case"ArrowDown":o.isOpen()||o.open(l.altKey?!1:"first","manual");break;case"ArrowUp":o.isOpen()?l.altKey&&(o.close(),o.resetInputValue(o.listState().selectionManager().selectedKeys())):o.open("last","manual");break;case"ArrowLeft":case"ArrowRight":h().setFocusedKey(void 0);break;case"Backspace":if(o.removeOnBackspace()&&h().selectionMode()==="multiple"&&o.inputValue()===""){let d=[...h().selectedKeys()].pop()??"";h().toggleSelection(d);}break}},N=l=>{callHandler(l,p.onFocus),!o.isInputFocused()&&o.setIsInputFocused(!0);},K=l=>{callHandler(l,p.onBlur),!(contains(o.controlRef(),l.relatedTarget)||contains(o.contentRef(),l.relatedTarget))&&o.setIsInputFocused(!1);},V=0;return createComponent(a$4,mergeProps({as:"input",ref(l){let d=mergeRefs(x=>{o.setInputRef(x),s=x;},p.ref);typeof d=="function"&&d(l);},get id(){return v.id()},get value(){return o.inputValue()},get required(){return n.isRequired()},get disabled(){return n.isDisabled()},get readonly(){return n.isReadOnly()},get placeholder(){return o.placeholder()},type:"text",role:"combobox",autoComplete:"off",autoCorrect:"off",spellCheck:"false","aria-haspopup":"listbox","aria-autocomplete":"list",get"aria-expanded"(){return o.isOpen()},get"aria-controls"(){return memo(()=>!!o.isOpen())()?o.listboxId():void 0},get"aria-activedescendant"(){return o.activeDescendant()},get"aria-label"(){return v.ariaLabel()},get"aria-labelledby"(){return v.ariaLabelledBy()},get"aria-describedby"(){return v.ariaDescribedBy()},get"aria-invalid"(){return n.validationState()==="invalid"||void 0},get"aria-required"(){return n.isRequired()||void 0},get"aria-disabled"(){return n.isDisabled()||void 0},get"aria-readonly"(){return n.isReadOnly()||void 0},onClick:I,onInput:$,onKeyDown:W,onFocus:N,onBlur:K,onTouchEnd:l=>{if(callHandler(l,p.onTouchEnd),!s||n.isReadOnly()||F())return;if(l.timeStamp-V<500){l.preventDefault(),s.focus();return}let d=l.target.getBoundingClientRect(),x=l.changedTouches[0],L=Math.ceil(d.left+.5*d.width),G=Math.ceil(d.top+.5*d.height);x.clientX===L&&x.clientY===G&&(l.preventDefault(),s.focus(),o.toggle(!1,"manual"),V=l.timeStamp);}},()=>o.dataset(),()=>n.dataset(),c))}function xo(i){let s=d(),n=f(),o=mergeDefaultProps({id:n.generateId("listbox")},i),[t,p]=splitProps(o,["ref"]),m=()=>s.getAriaLabelledBy(p.id,n.listboxAriaLabel(),void 0);return createEffect(()=>onCleanup(n.registerListboxId(p.id))),createComponent(f$2,mergeProps({ref(c){let g=mergeRefs(n.setListboxRef,t.ref);typeof g=="function"&&g(c);},get state(){return n.listState()},get autoFocus(){return n.autoFocus()},shouldUseVirtualFocus:!0,shouldSelectOnPressUp:!0,shouldFocusOnHover:!0,get"aria-label"(){return n.listboxAriaLabel()},get"aria-labelledby"(){return m()},get renderItem(){return n.renderItem},get renderSection(){return n.renderSection},get virtualized(){return n.isVirtualized()}},p))}function Po(i){let s=f();return createComponent(Show,{get when(){return s.contentPresent()},get children(){return createComponent(Portal,i)}})}function To(i){let s=d(),n=f(),[o,t]=splitProps(i,["ref","children"]),p=()=>n.listState().selectionManager();return createComponent(a$4,mergeProps({as:"div",ref(m){let c=mergeRefs(n.setControlRef,o.ref);typeof c=="function"&&c(m);}},()=>n.dataset(),()=>s.dataset(),t,{get children(){return createComponent(Dt,{state:{selectedOptions:()=>n.selectedOptions(),remove:m=>n.removeOptionFromSelection(m),clear:()=>p().clearSelection()},get children(){return o.children}})}}))}function Dt(i){let s=children(()=>{let n=i.children;return isFunction(n)?n(i.state):n});return memo(s)}function zo(i){let s=f();return createComponent(a$5,mergeProps({get collection(){return s.listState().collection()},get selectionManager(){return s.listState().selectionManager()},get isOpen(){return s.isOpen()},get isMultiple(){return s.isMultiple()},get isVirtualized(){return s.isVirtualized()},focusTrigger:()=>s.inputRef()?.focus()},i))}function jo(i){let s=f(),n=mergeDefaultProps({children:"\u25BC"},i);return createComponent(a$4,mergeProps({as:"span","aria-hidden":"true"},()=>s.dataset(),n))}var Be={focusAnnouncement:(i,s)=>`${i}${s?", selected":""}`,countAnnouncement:i=>{switch(i){case 1:return "one option available";}},selectedAnnouncement:i=>`${i}, selected`,triggerLabel:"Show suggestions",listboxLabel:"Suggestions"};function gn(i$1){let s=`combobox-${createUniqueId()}`,n=j({sensitivity:"base"}),o=mergeDefaultProps({id:s,selectionMode:"single",allowsEmptyCollection:!1,disallowEmptySelection:!1,allowDuplicateSelectionEvents:!0,closeOnSelection:i$1.selectionMode==="single",removeOnBackspace:!0,gutter:8,sameWidth:!0,modal:!1,defaultFilter:"contains",triggerMode:"input",translations:Be},i$1),[t,p,m,c$1]=splitProps(o,["noResetInputOnBlur","translations","itemComponent","sectionComponent","open","defaultOpen","onOpenChange","onInputChange","value","defaultValue","onChange","triggerMode","placeholder","options","optionValue","optionTextValue","optionLabel","optionDisabled","optionGroupChildren","keyboardDelegate","allowDuplicateSelectionEvents","disallowEmptySelection","defaultFilter","shouldFocusWrap","allowsEmptyCollection","closeOnSelection","removeOnBackspace","selectionBehavior","selectionMode","virtualized","modal","preventScroll","forceMount"],["getAnchorRect","placement","gutter","shift","flip","slide","overlap","sameWidth","fitViewport","hideWhenDetached","detachedPadding","arrowPadding","overflowPadding"],a$6),[g,h]=createSignal(),[F,v]=createSignal(),[I,$]=createSignal(),[W,N]=createSignal(),[K,V]=createSignal(),[z,l]=createSignal(),[d,x]=createSignal(!1),[L,G]=createSignal(!1),[q,oe]=createSignal(!1),[$e,ne]=createSignal(t.options),C=a$7({open:()=>t.open,defaultOpen:()=>t.defaultOpen,onOpenChange:e=>t.onOpenChange?.(e,ie)}),[H,U]=a$8({defaultValue:()=>"",onChange:e=>{t.onInputChange?.(e),e===""&&t.selectionMode==="single"&&!a.selectionManager().isEmpty()&&t.value===void 0&&a.selectionManager().setSelectedKeys([]),a.selectionManager().setFocusedKey(void 0);}}),P=e=>{let r=t.optionValue;return r==null?String(e):String(isFunction(r)?r(e):e[r])},We=e=>{let r=t.optionLabel;return r==null?String(e):String(isFunction(r)?r(e):e[r])},Ne=e=>{let r=t.optionTextValue;return r==null?String(e):String(isFunction(r)?r(e):e[r])},re=createMemo(()=>{let e=t.optionGroupChildren;return e==null?t.options:t.options.flatMap(r=>r[e]??r)}),se=e=>{let r=H()??"";if(isFunction(t.defaultFilter))return t.defaultFilter?.(e,r);let u=Ne(e);switch(t.defaultFilter){case"startsWith":return n.startsWith(u,r);case"endsWith":return n.endsWith(u,r);case"contains":return n.contains(u,r)}},X=createMemo(()=>{let e=t.optionGroupChildren;if(e==null)return t.options.filter(se);let r=[];for(let u of t.options){let b=u[e].filter(se);b.length!==0&&r.push({...u,[e]:b});}return r}),ze=createMemo(()=>C.isOpen()?q()?t.options:X():$e()),ie="focus",le=e=>[...e].map(r=>re().find(u=>P(u)===r)).filter(r=>r!=null),a=i({selectedKeys:()=>t.value!=null?t.value.map(P):t.value,defaultSelectedKeys:()=>t.defaultValue!=null?t.defaultValue.map(P):t.defaultValue,onSelectionChange:e=>{t.onChange?.(le(e)),t.closeOnSelection&&C.isOpen()&&e.size>0&&(A(),setTimeout(A));let r=I();r&&(r.setSelectionRange(r.value.length,r.value.length),focusWithoutScrolling(r));},allowDuplicateSelectionEvents:()=>access(t.allowDuplicateSelectionEvents),disallowEmptySelection:()=>t.disallowEmptySelection,selectionBehavior:()=>access(t.selectionBehavior),selectionMode:()=>t.selectionMode,dataSource:ze,getKey:()=>t.optionValue,getTextValue:()=>t.optionTextValue,getDisabled:()=>t.optionDisabled,getSectionChildren:()=>t.optionGroupChildren}),Ge=createMemo(()=>le(a.selectionManager().selectedKeys())),qe=e=>{a.selectionManager().toggleSelection(P(e));},{present:He}=Wt({show:()=>t.forceMount||C.isOpen(),element:()=>K()??null}),Y=(e,r)=>{if(t.triggerMode==="manual"&&r!=="manual"||!(oe(r==="manual")?t.options.length>0:X().length>0)&&!t.allowsEmptyCollection)return;ie=r,x(e),C.open();let E=a.selectionManager().firstSelectedKey();E==null&&(e==="first"?E=a.collection().getFirstKey():e==="last"&&(E=a.collection().getLastKey())),a.selectionManager().setFocused(!0),a.selectionManager().setFocusedKey(E);},A=()=>{C.close(),a.selectionManager().setFocused(!1),a.selectionManager().setFocusedKey(void 0);},Ue=(e,r)=>{C.isOpen()?A():Y(e,r);},{formControlContext:j$1}=b$1(m);a$9(I,()=>{let e=t.defaultValue?[...t.defaultValue].map(P):new a$a;a.selectionManager().setSelectedKeys(e);});let ae=createMemo(()=>{let e=access(t.keyboardDelegate);return e||new a$b(a.collection,z,void 0)}),Xe=e({selectionManager:()=>a.selectionManager(),keyboardDelegate:ae,disallowTypeAhead:!0,disallowEmptySelection:!0,shouldFocusWrap:()=>t.shouldFocusWrap,isVirtualized:!0},I),Ye=e=>{e&&t.triggerMode==="focus"&&Y(!1,"focus"),G(e),a.selectionManager().setFocused(e);},je=createMemo(()=>{let e=a.selectionManager().focusedKey();if(e)return z()?.querySelector(`[data-key="${e}"]`)?.id}),ce=e=>{if(t.selectionMode==="single"){let r=[...e][0],u=re().find(b=>P(b)===r);if(t.noResetInputOnBlur&&!u)return;U(u?We(u):"");}else {if(t.noResetInputOnBlur)return;U("");}},Je=e=>t.itemComponent?.({item:e}),Qe=e=>t.sectionComponent?.({section:e});createEffect(on([X,q],(e,r)=>{if(C.isOpen()&&r!=null){let u=r[0],b=r[1];ne(b?t.options:u);}else {let u=e[0],b=e[1];ne(b?t.options:u);}})),createEffect(on(H,()=>{q()&&oe(!1);})),createEffect(on(()=>a.selectionManager().selectedKeys(),ce));let ue="";createEffect(()=>{let e=a.selectionManager().focusedKey()??"",r=a.collection().getItem(e);if(isAppleDevice()&&r!=null&&e!==ue){let u=a.selectionManager().isSelected(e),b=t.translations?.focusAnnouncement(r?.textValue||"",u)??"";b$2(b);}e&&(ue=e);});let pe=a$c(a.collection()),de=C.isOpen();createEffect(()=>{let e=a$c(a.collection()),r=C.isOpen(),u=r!==de&&(a.selectionManager().focusedKey()==null||isAppleDevice());if(r&&(u||e!==pe)){let b=t.translations?.countAnnouncement(e)??"";b$2(b);}pe=e,de=r;});let fe="";createEffect(()=>{let e=[...a.selectionManager().selectedKeys()].pop()??"",r=a.collection().getItem(e);if(isAppleDevice()&&L()&&r&&e!==fe){let u=t.translations?.selectedAnnouncement(r?.textValue||"")??"";b$2(u);}e&&(fe=e);});let me=createMemo(()=>({"data-expanded":C.isOpen()?"":void 0,"data-closed":C.isOpen()?void 0:""})),ge={dataset:me,isOpen:C.isOpen,isDisabled:()=>j$1.isDisabled()??!1,isMultiple:()=>access(t.selectionMode)==="multiple",isVirtualized:()=>t.virtualized??!1,isModal:()=>t.modal??!1,preventScroll:()=>t.preventScroll??ge.isModal(),allowsEmptyCollection:()=>t.allowsEmptyCollection??!1,shouldFocusWrap:()=>t.shouldFocusWrap??!1,removeOnBackspace:()=>t.removeOnBackspace??!0,selectedOptions:Ge,isInputFocused:L,contentPresent:He,autoFocus:d,inputValue:H,triggerMode:()=>t.triggerMode,activeDescendant:je,controlRef:F,inputRef:I,triggerRef:W,contentRef:K,listState:()=>a,keyboardDelegate:ae,listboxId:g,triggerAriaLabel:()=>t.translations?.triggerLabel,listboxAriaLabel:()=>t.translations?.listboxLabel,setIsInputFocused:Ye,resetInputValue:ce,setInputValue:U,setControlRef:v,setInputRef:$,setTriggerRef:N,setContentRef:V,setListboxRef:l,open:Y,close:A,toggle:Ue,placeholder:()=>t.placeholder,renderItem:Je,renderSection:Qe,removeOptionFromSelection:qe,onInputKeyDown:e=>Xe.onKeyDown(e),generateId:createGenerateId(()=>access(m.id)),registerListboxId:a$d(h)};return createComponent(c.Provider,{value:j$1,get children(){return createComponent(Q.Provider,{value:ge,get children(){return createComponent(f$1,mergeProps({anchorRef:F,contentRef:K},p,{get children(){return createComponent(a$4,mergeProps({as:"div",role:"group",get id(){return access(m.id)}},()=>j$1.dataset(),me,c$1))}}))}})}})}

export { f as a, to as b, po as c, xo as d, Po as e, To as f, zo as g, jo as h, gn as i };
