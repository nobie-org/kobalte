import { c } from './BRRMFPGI.js';
import { access, mergeDefaultProps, addItemToArray, getDocument } from '@kobalte/utils';
import { createContext, useContext, createComponent, createEffect, onCleanup } from 'solid-js';

var s=createContext();function y(){return useContext(s)}function u(){let e=y();if(e===void 0)throw new Error("[kobalte]: `useDomCollectionContext` must be used within a `DomCollectionProvider` component");return e}function p(e,n){return !!(n.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_PRECEDING)}function D(e,n){let t=n.ref();if(!t)return -1;let o=e.length;if(!o)return -1;for(;o--;){let i=e[o]?.ref();if(i&&p(i,t))return o+1}return 0}function P(e){let n=e.map((o,i)=>[i,o]),t=!1;return n.sort(([o,i],[r,m])=>{let l=i.ref(),c=m.ref();return l===c||!l||!c?0:p(l,c)?(o>r&&(t=!0),-1):(o<r&&(t=!0),1)}),t?n.map(([o,i])=>i):e}function I(e,n){let t=P(e);e!==t&&n(t);}function h(e){let n=e[0],t=e[e.length-1]?.ref(),o=n?.ref()?.parentElement;for(;o;){if(t&&o.contains(t))return o;o=o.parentElement;}return getDocument(o).body}function O(e,n){createEffect(()=>{let t=setTimeout(()=>{I(e(),n);});onCleanup(()=>clearTimeout(t));});}function d(e,n){if(typeof IntersectionObserver!="function"){O(e,n);return}let t=[];createEffect(()=>{let o=()=>{let m=!!t.length;t=e(),m&&I(e(),n);},i=h(e()),r=new IntersectionObserver(o,{root:i});for(let m of e()){let l=m.ref();l&&r.observe(l);}onCleanup(()=>r.disconnect());});}function j(e={}){let[n,t]=c({value:()=>access(e.items),onChange:r=>e.onItemsChange?.(r)});d(n,t);let o=r=>(t(m=>{let l=D(m,r);return addItemToArray(m,r,l)}),()=>{t(m=>{let l=m.filter(c=>c.ref()!==r.ref());return m.length===l.length?m:l});});return {DomCollectionProvider:r=>createComponent(s.Provider,{value:{registerItem:o},get children(){return r.children}})}}function K(e){let n=u(),t=mergeDefaultProps({shouldRegisterItem:!0},e);createEffect(()=>{if(!t.shouldRegisterItem)return;let o=n.registerItem(t.getItem());onCleanup(o);});}

export { s as a, y as b, u as c, j as d, K as e };
