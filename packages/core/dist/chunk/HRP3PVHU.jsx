import{a as m}from"./H4JCYUZR.jsx";import{a as l}from"./YIWNW6LG.jsx";import{b as o}from"./H2DQBBBH.jsx";import{a as D}from"./HAEWETXL.jsx";import{contains as L,getDocument as T,mergeRefs as w}from"@kobalte/utils";import{createEffect as g,on as M,onCleanup as P,onMount as h,splitProps as B}from"solid-js";import{createContext as x,useContext as C}from"solid-js";var a=x();function E(){return C(a)}function G(f){let t,d=E(),[s,v]=B(f,["ref","disableOutsidePointerEvents","excludedElements","onEscapeKeyDown","onPointerDownOutside","onFocusOutside","onInteractOutside","onDismiss","bypassTopMostLayerCheck"]),i=new Set([]),O=e=>{i.add(e);let n=d?.registerNestedLayer(e);return()=>{i.delete(e),n?.()}};m({shouldExcludeElement:e=>t?s.excludedElements?.some(n=>L(n(),e))||[...i].some(n=>L(n,e)):!1,onPointerDownOutside:e=>{!t||o.isBelowPointerBlockingLayer(t)||!s.bypassTopMostLayerCheck&&!o.isTopMostLayer(t)||(s.onPointerDownOutside?.(e),s.onInteractOutside?.(e),e.defaultPrevented||s.onDismiss?.())},onFocusOutside:e=>{s.onFocusOutside?.(e),s.onInteractOutside?.(e),e.defaultPrevented||s.onDismiss?.()}},()=>t),l({ownerDocument:()=>T(t),onEscapeKeyDown:e=>{!t||!o.isTopMostLayer(t)||(s.onEscapeKeyDown?.(e),!e.defaultPrevented&&s.onDismiss&&(e.preventDefault(),s.onDismiss()))}}),h(()=>{if(!t)return;o.addLayer({node:t,isPointerBlocking:s.disableOutsidePointerEvents,dismiss:s.onDismiss});let e=d?.registerNestedLayer(t);o.assignPointerEventToLayers(),o.disableBodyPointerEvents(t),P(()=>{t&&(o.removeLayer(t),e?.(),o.assignPointerEventToLayers(),o.restoreBodyPointerEvents(t))})}),g(M([()=>t,()=>s.disableOutsidePointerEvents],([e,n])=>{if(!e)return;let r=o.find(e);r&&r.isPointerBlocking!==n&&(r.isPointerBlocking=n,o.assignPointerEventToLayers()),n&&o.disableBodyPointerEvents(e),P(()=>{o.restoreBodyPointerEvents(e)})},{defer:!0}));let b={registerNestedLayer:O};return<a.Provider value={b}><D as="div"ref={w(e=>t=e,s.ref)}{...v}/></a.Provider>}export{G as a};
