import{a as Ve}from"./T6FUUJPP.jsx";import{f as Ae}from"./XMAAZF36.jsx";import{a as Q}from"./IS3KSOW7.jsx";import{f as X}from"./I2GXMTLG.jsx";import{a as Ee,b as Te}from"./YU3BENDD.jsx";import{a as ye}from"./RQL65DCQ.jsx";import{a as Pe,b as ve,c as he,d as I}from"./HIUHMFLS.jsx";import{a as De}from"./GU5T4K6H.jsx";import{a as Ie,e as Le,i as Fe}from"./M3KDFM4U.jsx";import{j as Me}from"./ZSYY5OQU.jsx";import{a as ge}from"./CHPFHOO4.jsx";import{a as Oe}from"./VYWZPHCB.jsx";import{a as Re}from"./HRP3PVHU.jsx";import{b as B}from"./24EX2HEU.jsx";import{a as xe}from"./OYIYGTZT.jsx";import{a as Se}from"./LD6VFCOU.jsx";import{a as Ce}from"./A5YUKSV6.jsx";import{a as O}from"./HAEWETXL.jsx";import{createContext as je,useContext as Ye}from"solid-js";var Z=je();function m(){let l=Ye(Z);if(l===void 0)throw new Error("[kobalte]: `useComboboxContext` must be used within a `Combobox` component");return l}import{focusWithoutScrolling as Qe,mergeRefs as Ze}from"@kobalte/utils";import{Show as Co,splitProps as xo}from"solid-js";import{combineStyle as go}from"@solid-primitives/props";import yo from"solid-prevent-scroll";function Qo(l){let s,n=m(),[t,o]=xo(l,["ref","style","onCloseAutoFocus","onFocusOutside"]),d=()=>{n.resetInputValue(n.listState().selectionManager().selectedKeys()),n.close(),setTimeout(()=>{n.close()})},C=c=>{t.onFocusOutside?.(c),n.isOpen()&&n.isModal()&&c.preventDefault()};return Oe({isDisabled:()=>!(n.isOpen()&&n.isModal()),targets:()=>{let c=[];s&&c.push(s);let S=n.controlRef();return S&&c.push(S),c}}),yo({element:()=>s??null,enabled:()=>n.contentPresent()&&n.preventScroll()}),ge({trapFocus:()=>n.isOpen()&&n.isModal(),onMountAutoFocus:c=>{c.preventDefault()},onUnmountAutoFocus:c=>{t.onCloseAutoFocus?.(c),c.defaultPrevented||(Qe(n.inputRef()),c.preventDefault())}},()=>s),<Co when={n.contentPresent()}><X.Positioner><Re ref={Ze(c=>{n.setContentRef(c),s=c},t.ref)}disableOutsidePointerEvents={n.isModal()&&n.isOpen()}excludedElements={[n.controlRef]}style={go({"--kb-combobox-content-transform-origin":"var(--kb-popper-content-transform-origin)",position:"relative"},t.style)}onFocusOutside={C}onDismiss={d}{...n.dataset()}{...o}/></X.Positioner></Co>}import{callHandler as P,contains as He,mergeDefaultProps as Oo,mergeRefs as So}from"@kobalte/utils";import{splitProps as Po}from"solid-js";function st(l){let s,n=I(),t=m(),o=Oo({id:t.generateId("input")},l),[d,C,c]=Po(o,["ref","disabled","onClick","onInput","onKeyDown","onFocus","onBlur","onTouchEnd"],Ee),S=()=>t.listState().collection(),g=()=>t.listState().selectionManager(),h=()=>d.disabled||t.isDisabled()||n.isDisabled(),{fieldProps:E}=Te(C),T=i=>{P(i,d.onClick),t.triggerMode()==="focus"&&!t.isOpen()&&t.open(!1,"focus")},J=i=>{if(P(i,d.onInput),n.isReadOnly()||h())return;let u=i.target;t.setInputValue(u.value),u.value=t.inputValue()??"",t.isOpen()?S().getSize()<=0&&!t.allowsEmptyCollection()&&t.close():(S().getSize()>0||t.allowsEmptyCollection())&&t.open(!1,"input")},N=i=>{if(P(i,d.onKeyDown),!(n.isReadOnly()||h()))switch(t.isOpen()&&P(i,t.onInputKeyDown),i.key){case"Enter":if(t.isOpen()){i.preventDefault();let u=g().focusedKey();u!=null&&g().select(u)}break;case"Tab":t.isOpen()&&(t.close(),t.resetInputValue(t.listState().selectionManager().selectedKeys()));break;case"Escape":t.isOpen()?(t.close(),t.resetInputValue(t.listState().selectionManager().selectedKeys())):t.setInputValue("");break;case"ArrowDown":t.isOpen()||t.open(i.altKey?!1:"first","manual");break;case"ArrowUp":t.isOpen()?i.altKey&&(t.close(),t.resetInputValue(t.listState().selectionManager().selectedKeys())):t.open("last","manual");break;case"ArrowLeft":case"ArrowRight":g().setFocusedKey(void 0);break;case"Backspace":if(t.removeOnBackspace()&&g().selectionMode()==="multiple"&&t.inputValue()===""){let u=[...g().selectedKeys()].pop()??"";g().toggleSelection(u)}break}},W=i=>{P(i,d.onFocus),!t.isInputFocused()&&t.setIsInputFocused(!0)},D=i=>{P(i,d.onBlur),!(He(t.controlRef(),i.relatedTarget)||He(t.contentRef(),i.relatedTarget))&&t.setIsInputFocused(!1)},R=0,A=i=>{if(P(i,d.onTouchEnd),!s||n.isReadOnly()||h())return;if(i.timeStamp-R<500){i.preventDefault(),s.focus();return}let u=i.target.getBoundingClientRect(),V=i.changedTouches[0],H=Math.ceil(u.left+.5*u.width),U=Math.ceil(u.top+.5*u.height);V.clientX===H&&V.clientY===U&&(i.preventDefault(),s.focus(),t.toggle(!1,"manual"),R=i.timeStamp)};return<O as="input"ref={So(i=>{t.setInputRef(i),s=i},d.ref)}id={E.id()}value={t.inputValue()}required={n.isRequired()}disabled={n.isDisabled()}readonly={n.isReadOnly()}placeholder={t.placeholder()}type="text"role="combobox"autoComplete="off"autoCorrect="off"spellCheck="false"aria-haspopup="listbox"aria-autocomplete="list"aria-expanded={t.isOpen()}aria-controls={t.isOpen()?t.listboxId():void 0}aria-activedescendant={t.activeDescendant()}aria-label={E.ariaLabel()}aria-labelledby={E.ariaLabelledBy()}aria-describedby={E.ariaDescribedBy()}aria-invalid={n.validationState()==="invalid"||void 0}aria-required={n.isRequired()||void 0}aria-disabled={n.isDisabled()||void 0}aria-readonly={n.isReadOnly()||void 0}onClick={T}onInput={J}onKeyDown={N}onFocus={W}onBlur={D}onTouchEnd={A}{...t.dataset()}{...n.dataset()}{...c}/>}import{mergeDefaultProps as vo,mergeRefs as ho}from"@kobalte/utils";import{createEffect as Eo,onCleanup as To,splitProps as Mo}from"solid-js";function ut(l){let s=I(),n=m(),t=vo({id:n.generateId("listbox")},l),[o,d]=Mo(t,["ref"]),C=()=>s.getAriaLabelledBy(d.id,n.listboxAriaLabel(),void 0);return Eo(()=>To(n.registerListboxId(d.id))),<Ae ref={ho(n.setListboxRef,o.ref)}state={n.listState()}autoFocus={n.autoFocus()}shouldUseVirtualFocus shouldSelectOnPressUp shouldFocusOnHover aria-label={n.listboxAriaLabel()}aria-labelledby={C()}renderItem={n.renderItem}renderSection={n.renderSection}virtualized={n.isVirtualized()}{...d}/>}import{Show as Io}from"solid-js";import{Portal as Lo}from"solid-js/web";function xt(l){let s=m();return<Io when={s.contentPresent()}><Lo{...l}/></Io>}import{isFunction as Fo,mergeRefs as Do}from"@kobalte/utils";import{children as Ro,splitProps as Ao}from"solid-js";function Et(l){let s=I(),n=m(),[t,o]=Ao(l,["ref","children"]),d=()=>n.listState().selectionManager();return<O as="div"ref={Do(n.setControlRef,t.ref)}{...n.dataset()}{...s.dataset()}{...o}><Vo state={{selectedOptions:()=>n.selectedOptions(),remove:C=>n.removeOptionFromSelection(C),clear:()=>d().clearSelection()}}>{t.children}</Vo></O>}function Vo(l){let s=Ro(()=>{let n=l.children;return Fo(n)?n(l.state):n});return<>{s()}</>}function Lt(l){let s=m();return<Ve collection={s.listState().collection()}selectionManager={s.listState().selectionManager()}isOpen={s.isOpen()}isMultiple={s.isMultiple()}isVirtualized={s.isVirtualized()}focusTrigger={()=>s.inputRef()?.focus()}{...l}/>}import{mergeDefaultProps as Ho}from"@kobalte/utils";function Vt(l){let s=m(),n=Ho({children:"\u25BC"},l);return<O as="span"aria-hidden="true"{...s.dataset()}{...n}/>}import{access as L,createGenerateId as wo,focusWithoutScrolling as Ko,isAppleDevice as ee,isFunction as G,mergeDefaultProps as Bo}from"@kobalte/utils";import{createEffect as F,createMemo as v,createSignal as x,createUniqueId as ko,on as oe,splitProps as Xo}from"solid-js";import Go from"solid-presence";var we={focusAnnouncement:(l,s)=>`${l}${s?", selected":""}`,countAnnouncement:l=>{switch(l){case 1:return"one option available";default:`${l}`}},selectedAnnouncement:l=>`${l}, selected`,triggerLabel:"Show suggestions",listboxLabel:"Suggestions"};function Yt(l){let s=`combobox-${ko()}`,n=Me({sensitivity:"base"}),t=Bo({id:s,selectionMode:"single",allowsEmptyCollection:!1,disallowEmptySelection:!1,allowDuplicateSelectionEvents:!0,closeOnSelection:l.selectionMode==="single",removeOnBackspace:!0,gutter:8,sameWidth:!0,modal:!1,defaultFilter:"contains",triggerMode:"input",translations:we},l),[o,d,C,c]=Xo(t,["noResetInputOnBlur","translations","itemComponent","sectionComponent","open","defaultOpen","onOpenChange","onInputChange","value","defaultValue","onChange","triggerMode","placeholder","options","optionValue","optionTextValue","optionLabel","optionDisabled","optionGroupChildren","keyboardDelegate","allowDuplicateSelectionEvents","disallowEmptySelection","defaultFilter","shouldFocusWrap","allowsEmptyCollection","closeOnSelection","removeOnBackspace","selectionBehavior","selectionMode","virtualized","modal","preventScroll","forceMount"],["getAnchorRect","placement","gutter","shift","flip","slide","overlap","sameWidth","fitViewport","hideWhenDetached","detachedPadding","arrowPadding","overflowPadding"],Pe),[S,g]=x(),[h,E]=x(),[T,J]=x(),[N,W]=x(),[D,R]=x(),[A,i]=x(),[u,V]=x(!1),[H,U]=x(!1),[z,te]=x(!1),[Ke,ne]=x(o.options),f=xe({open:()=>o.open,defaultOpen:()=>o.defaultOpen,onOpenChange:e=>o.onOpenChange?.(e,ie)}),[_,q]=Ce({defaultValue:()=>"",onChange:e=>{o.onInputChange?.(e),e===""&&o.selectionMode==="single"&&!a.selectionManager().isEmpty()&&o.value===void 0&&a.selectionManager().setSelectedKeys([]),a.selectionManager().setFocusedKey(void 0)}}),M=e=>{let r=o.optionValue;return r==null?String(e):String(G(r)?r(e):e[r])},Be=e=>{let r=o.optionLabel;return r==null?String(e):String(G(r)?r(e):e[r])},ke=e=>{let r=o.optionTextValue;return r==null?String(e):String(G(r)?r(e):e[r])},re=v(()=>{let e=o.optionGroupChildren;return e==null?o.options:o.options.flatMap(r=>r[e]??r)}),se=e=>{let r=_()??"";if(G(o.defaultFilter))return o.defaultFilter?.(e,r);let p=ke(e);switch(o.defaultFilter){case"startsWith":return n.startsWith(p,r);case"endsWith":return n.endsWith(p,r);case"contains":return n.contains(p,r)}},$=v(()=>{let e=o.optionGroupChildren;if(e==null)return o.options.filter(se);let r=[];for(let p of o.options){let b=p[e].filter(se);b.length!==0&&r.push({...p,[e]:b})}return r}),Xe=v(()=>f.isOpen()?z()?o.options:$():Ke()),ie="focus",le=e=>[...e].map(r=>re().find(p=>M(p)===r)).filter(r=>r!=null),a=Fe({selectedKeys:()=>o.value!=null?o.value.map(M):o.value,defaultSelectedKeys:()=>o.defaultValue!=null?o.defaultValue.map(M):o.defaultValue,onSelectionChange:e=>{o.onChange?.(le(e)),o.closeOnSelection&&f.isOpen()&&e.size>0&&(w(),setTimeout(w));let r=T();r&&(r.setSelectionRange(r.value.length,r.value.length),Ko(r))},allowDuplicateSelectionEvents:()=>L(o.allowDuplicateSelectionEvents),disallowEmptySelection:()=>o.disallowEmptySelection,selectionBehavior:()=>L(o.selectionBehavior),selectionMode:()=>o.selectionMode,dataSource:Xe,getKey:()=>o.optionValue,getTextValue:()=>o.optionTextValue,getDisabled:()=>o.optionDisabled,getSectionChildren:()=>o.optionGroupChildren}),Ge=v(()=>le(a.selectionManager().selectedKeys())),Je=e=>{a.selectionManager().toggleSelection(M(e))},{present:Ne}=Go({show:()=>o.forceMount||f.isOpen(),element:()=>D()??null}),j=(e,r)=>{if(o.triggerMode==="manual"&&r!=="manual"||!(te(r==="manual")?o.options.length>0:$().length>0)&&!o.allowsEmptyCollection)return;ie=r,V(e),f.open();let K=a.selectionManager().firstSelectedKey();K==null&&(e==="first"?K=a.collection().getFirstKey():e==="last"&&(K=a.collection().getLastKey())),a.selectionManager().setFocused(!0),a.selectionManager().setFocusedKey(K)},w=()=>{f.close(),a.selectionManager().setFocused(!1),a.selectionManager().setFocusedKey(void 0)},We=(e,r)=>{f.isOpen()?w():j(e,r)},{formControlContext:Y}=ve(C);ye(T,()=>{let e=o.defaultValue?[...o.defaultValue].map(M):new Ie;a.selectionManager().setSelectedKeys(e)});let ae=v(()=>{let e=L(o.keyboardDelegate);return e||new De(a.collection,A,void 0)}),Ue=Le({selectionManager:()=>a.selectionManager(),keyboardDelegate:ae,disallowTypeAhead:!0,disallowEmptySelection:!0,shouldFocusWrap:()=>o.shouldFocusWrap,isVirtualized:!0},T),ze=e=>{e&&o.triggerMode==="focus"&&j(!1,"focus"),U(e),a.selectionManager().setFocused(e)},_e=v(()=>{let e=a.selectionManager().focusedKey();if(e)return A()?.querySelector(`[data-key="${e}"]`)?.id}),pe=e=>{if(o.selectionMode==="single"){let r=[...e][0],p=re().find(b=>M(b)===r);if(o.noResetInputOnBlur&&!p)return;q(p?Be(p):"")}else{if(o.noResetInputOnBlur)return;q("")}},qe=e=>o.itemComponent?.({item:e}),$e=e=>o.sectionComponent?.({section:e});F(oe([$,z],(e,r)=>{if(f.isOpen()&&r!=null){let p=r[0],b=r[1];ne(b?o.options:p)}else{let p=e[0],b=e[1];ne(b?o.options:p)}})),F(oe(_,()=>{z()&&te(!1)})),F(oe(()=>a.selectionManager().selectedKeys(),pe));let ce="";F(()=>{let e=a.selectionManager().focusedKey()??"",r=a.collection().getItem(e);if(ee()&&r!=null&&e!==ce){let p=a.selectionManager().isSelected(e),b=o.translations?.focusAnnouncement(r?.textValue||"",p)??"";B(b)}e&&(ce=e)});let de=Q(a.collection()),ue=f.isOpen();F(()=>{let e=Q(a.collection()),r=f.isOpen(),p=r!==ue&&(a.selectionManager().focusedKey()==null||ee());if(r&&(p||e!==de)){let b=o.translations?.countAnnouncement(e)??"";B(b)}de=e,ue=r});let me="";F(()=>{let e=[...a.selectionManager().selectedKeys()].pop()??"",r=a.collection().getItem(e);if(ee()&&H()&&r&&e!==me){let p=o.translations?.selectedAnnouncement(r?.textValue||"")??"";B(p)}e&&(me=e)});let be=v(()=>({"data-expanded":f.isOpen()?"":void 0,"data-closed":f.isOpen()?void 0:""})),fe={dataset:be,isOpen:f.isOpen,isDisabled:()=>Y.isDisabled()??!1,isMultiple:()=>L(o.selectionMode)==="multiple",isVirtualized:()=>o.virtualized??!1,isModal:()=>o.modal??!1,preventScroll:()=>o.preventScroll??fe.isModal(),allowsEmptyCollection:()=>o.allowsEmptyCollection??!1,shouldFocusWrap:()=>o.shouldFocusWrap??!1,removeOnBackspace:()=>o.removeOnBackspace??!0,selectedOptions:Ge,isInputFocused:H,contentPresent:Ne,autoFocus:u,inputValue:_,triggerMode:()=>o.triggerMode,activeDescendant:_e,controlRef:h,inputRef:T,triggerRef:N,contentRef:D,listState:()=>a,keyboardDelegate:ae,listboxId:S,triggerAriaLabel:()=>o.translations?.triggerLabel,listboxAriaLabel:()=>o.translations?.listboxLabel,setIsInputFocused:ze,resetInputValue:pe,setInputValue:q,setControlRef:E,setInputRef:J,setTriggerRef:W,setContentRef:R,setListboxRef:i,open:j,close:w,toggle:We,placeholder:()=>o.placeholder,renderItem:qe,renderSection:$e,removeOptionFromSelection:Je,onInputKeyDown:e=>Ue.onKeyDown(e),generateId:wo(()=>L(C.id)),registerListboxId:Se(g)};return<he.Provider value={Y}><Z.Provider value={fe}><X anchorRef={h}contentRef={D}{...d}><O as="div"role="group"id={L(C.id)}{...Y.dataset()}{...be()}{...c}/></X></Z.Provider></he.Provider>}export{m as a,Qo as b,st as c,ut as d,xt as e,Et as f,Lt as g,Vt as h,Yt as i};
