import { access, isString, isNumber } from '@kobalte/utils';
import { createMemo } from 'solid-js';

function s(t){let o=t.startIndex??0,r=t.startLevel??0,l=[],g=e=>{if(e==null)return "";let n=t.getKey??"key",i=isString(n)?e[n]:n(e);return i!=null?String(i):""},y=e=>{if(e==null)return "";let n=t.getTextValue??"textValue",i=isString(n)?e[n]:n(e);return i!=null?String(i):""},a=e=>{if(e==null)return !1;let n=t.getDisabled??"disabled";return (isString(n)?e[n]:n(e))??!1},u=e=>{if(e!=null)return isString(t.getSectionChildren)?e[t.getSectionChildren]:t.getSectionChildren?.(e)};for(let e of t.dataSource){if(isString(e)||isNumber(e)){l.push({type:"item",rawValue:e,key:String(e),textValue:String(e),disabled:a(e),level:r,index:o}),o++;continue}if(u(e)!=null){l.push({type:"section",rawValue:e,key:"",textValue:"",disabled:!1,level:r,index:o}),o++;let n=u(e)??[];if(n.length>0){let i=s({dataSource:n,getKey:t.getKey,getTextValue:t.getTextValue,getDisabled:t.getDisabled,getSectionChildren:t.getSectionChildren,startIndex:o,startLevel:r+1});l.push(...i),o+=i.length;}}else l.push({type:"item",rawValue:e,key:g(e),textValue:y(e),disabled:a(e),level:r,index:o}),o++;}return l}function m(t,o=[]){return createMemo(()=>{let r=s({dataSource:access(t.dataSource),getKey:access(t.getKey),getTextValue:access(t.getTextValue),getDisabled:access(t.getDisabled),getSectionChildren:access(t.getSectionChildren)});for(let l=0;l<o.length;l++)o[l]();return t.factory(r)})}

export { m as a };
