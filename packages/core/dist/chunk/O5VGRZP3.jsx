import{access as d}from"@kobalte/utils";import{createMemo as f}from"solid-js";import{isNumber as C,isString as c}from"@kobalte/utils";function s(t){let o=t.startIndex??0,r=t.startLevel??0,l=[],g=e=>{if(e==null)return"";let n=t.getKey??"key",i=c(n)?e[n]:n(e);return i!=null?String(i):""},y=e=>{if(e==null)return"";let n=t.getTextValue??"textValue",i=c(n)?e[n]:n(e);return i!=null?String(i):""},a=e=>{if(e==null)return!1;let n=t.getDisabled??"disabled";return(c(n)?e[n]:n(e))??!1},u=e=>{if(e!=null)return c(t.getSectionChildren)?e[t.getSectionChildren]:t.getSectionChildren?.(e)};for(let e of t.dataSource){if(c(e)||C(e)){l.push({type:"item",rawValue:e,key:String(e),textValue:String(e),disabled:a(e),level:r,index:o}),o++;continue}if(u(e)!=null){l.push({type:"section",rawValue:e,key:"",textValue:"",disabled:!1,level:r,index:o}),o++;let n=u(e)??[];if(n.length>0){let i=s({dataSource:n,getKey:t.getKey,getTextValue:t.getTextValue,getDisabled:t.getDisabled,getSectionChildren:t.getSectionChildren,startIndex:o,startLevel:r+1});l.push(...i),o+=i.length}}else l.push({type:"item",rawValue:e,key:g(e),textValue:y(e),disabled:a(e),level:r,index:o}),o++}return l}function m(t,o=[]){return f(()=>{let r=s({dataSource:d(t.dataSource),getKey:d(t.getKey),getTextValue:d(t.getTextValue),getDisabled:d(t.getDisabled),getSectionChildren:d(t.getSectionChildren)});for(let l=0;l<o.length;l++)o[l]();return t.factory(r)})}export{m as a};
