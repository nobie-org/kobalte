import{createContext as E,createMemo as v,useContext as w}from"solid-js";var m=E();function T(){let o=w(m);if(o===void 0)throw new Error("[kobalte]: `useColorMode` must be used within a `ColorModeProvider`");return o}function V(o,e){let{colorMode:t}=T();return v(()=>t()==="dark"?e:o)}import{createEffect as P,createSignal as b,onCleanup as D}from"solid-js";import{isServer as p}from"solid-js/web";var a="kb-color-mode";function O(o){return{ssr:!1,type:"localStorage",get:e=>{if(p)return e;let t;try{t=localStorage.getItem(o)}catch{}return t??e},set:e=>{try{localStorage.setItem(o,e)}catch{}}}}var u=O(a);function g(o,e){return o.match(new RegExp(`(^| )${e}=([^;]+)`))?.[2]}function f(o,e){return{ssr:!!e,type:"cookie",get:t=>e?g(e,o)??t:p?t:g(document.cookie,o)??t,set:t=>{document.cookie=`${o}=${t}; max-age=31536000; path=/`}}}var B=f(a);function z(o){return f(a,o)}import{isServer as _}from"solid-js/web";var i="system";function h(){return window.matchMedia("(prefers-color-scheme: dark)")}function A(){let o=document.createElement("style");return o.appendChild(document.createTextNode("*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(o),()=>{window.getComputedStyle(document.body),requestAnimationFrame(()=>{requestAnimationFrame(()=>{document.head.removeChild(o)})})}}function y(o,e=!0){let t=e?A():void 0;document.documentElement.dataset.kbTheme=o,document.documentElement.style.colorScheme=o,t?.()}function C(o){return h().matches??o==="dark"?"dark":"light"}function S(o){let e="light",t=o.get(e)??e;return t==="system"?_?e:C():t}function x(o){let e=h(),t=r=>{o(r.matches?"dark":"light")};return e.addEventListener("change",t),()=>{e.removeEventListener("change",t)}}function W(o){let e=()=>o.initialColorMode??i,t=()=>o.storageManager??u,r,[c,d]=b(S(t())),s=n=>{d(n),y(n,o.disableTransitionOnChange)},l=n=>{r&&(r(),r=void 0);let M=n==="system";M&&(r=x(s)),s(M?C():n),t().set(n)},k=()=>{l(c()==="dark"?"light":"dark")};P(()=>{l(t().get()??e())}),D(()=>{r?.()});let L={colorMode:c,setColorMode:l,toggleColorMode:k};return<m.Provider value={L}>{o.children}</m.Provider>}import{createMemo as R,mergeProps as K}from"solid-js";var $=new Set(["light","dark","system"]);function I(o){return $.has(o)?o:i}function to(o){let e=K({initialColorMode:i,storageType:"localStorage",storageKey:a},o),t=R(()=>{let r=I(e.initialColorMode),c=`(function(){try{var a=function(o){var l="(prefers-color-scheme: dark)",v=window.matchMedia(l).matches?"dark":"light",e=o==="system"?v:o,d=document.documentElement,s=e==="dark";return d.style.colorScheme=e,d.dataset.kbTheme=e,o},u=a,h="${r}",r="${e.storageKey}",t=document.cookie.match(new RegExp("(^| )".concat(r,"=([^;]+)"))),c=t?t[2]:null;c?a(c):document.cookie="".concat(r,"=").concat(a(h),"; max-age=31536000; path=/")}catch(a){}})();`,d=`(function(){try{var a=function(c){var v="(prefers-color-scheme: dark)",h=window.matchMedia(v).matches?"dark":"light",r=c==="system"?h:c,o=document.documentElement,i=r==="dark";return o.style.colorScheme=r,o.dataset.kbTheme=r,c},n=a,m="${r}",e="${e.storageKey}",t=localStorage.getItem(e);t?a(t):localStorage.setItem(e,a(m))}catch(a){}})();`;return`!${e.storageType==="cookie"?c:d}`.trim()});return<script id="kb-color-mode-script"nonce={e.nonce}innerHTML={t()}/>}export{m as a,T as b,V as c,a as d,O as e,u as f,f as g,B as h,z as i,W as j,to as k};
