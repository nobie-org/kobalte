import { a } from '../chunk/DBH56JRW.js';
export { a as ErrorMessage } from '../chunk/DBH56JRW.js';
import { e, d, a as a$3, b, c as c$1 } from '../chunk/63IHFG6C.js';
export { e as Description } from '../chunk/63IHFG6C.js';
import { a as a$2 } from '../chunk/STCLCRSQ.js';
import { a as a$1 } from '../chunk/2B777EKY.js';
import { createContext, useContext, createSignal, splitProps, For, Show, createEffect, onCleanup, createUniqueId } from 'solid-js';
import { template, createComponent, mergeProps, use, spread } from 'solid-js/web';
import { mergeRefs, composeEventHandlers, visuallyHiddenStyles, mergeDefaultProps } from '@kobalte/utils';
import { combineStyle } from '@solid-primitives/props';
import { createStore, unwrap } from 'solid-js/store';

var P=createContext();function c(){let e=useContext(P);if(e===void 0)throw new Error("[kobalte]: `useFileFieldContext` must be used within a `FileFieldContext.Root` component");return e}var ne=(e,t)=>{if(e&&t){let o=Array.isArray(t)?t:t.split(","),r=e.name||"",i=(e.type||"").toLowerCase(),m=i.replace(/\/.*$/,"");return o.some(a=>{let n=a.trim().toLowerCase();return n.charAt(0)==="."?r.toLowerCase().endsWith(n):n.endsWith("/*")?m===n.replace(/\/.*$/,""):i===n})}return !0},se=(e,t,o)=>{if(e.size)if(t&&o){if(e.size>o)return [!1,"FILE_TOO_LARGE"];if(e.size<t)return [!1,"FILE_TOO_SMALL"]}else {if(t&&e.size<t)return [!1,"FILE_TOO_SMALL"];if(o&&e.size>o)return [!1,"FILE_TOO_LARGE"]}return [!0,null]},le=(e,t)=>{let o=e.type==="application/x-moz-file"||ne(e,t);return [o,o?null:"FILE_INVALID_TYPE"]},me=(e,t,o)=>!t&&e>1?!1:e<=o,N=(e,t,o,r,i,m,a)=>{let n=[],d=[];for(let f of e){let[l,s]=le(f,t),[g,x]=se(f,i,m),I=a?.(f),h=I?I.length===0:!0;if(l&&g&&h)n.push(f);else {let y=[s,x];h||y.push(...I??[]),d.push({file:f,errors:y.filter(Boolean)});}}if(!me(n.length,!!o,r)){for(let f of n)d.push({file:f,errors:["TOO_MANY_FILES"]});n.splice(0);}return {acceptedFiles:n,rejectedFiles:d}},E=e=>e.dataTransfer?e.dataTransfer.types.some(t=>t==="Files"||t==="application/x-moz-file"):!!e.target&&"files"in e.target,T=e=>{if(typeof e=="string")return e;if(Array.isArray(e))return e.join(",")};function j(e){let[t,o]=createSignal(!1),r=c(),[i,m]=splitProps(e,["ref","onClick","onKeyDown","onDragOver","onDragLeave","onDrop"]),a=s=>{s.target.tagName==="LABEL"?s.stopPropagation():r.fileInputRef()?.click();},n=s=>{s.defaultPrevented||s.key!=="Enter"&&s.key!==" "||r.fileInputRef()?.click();},d=s=>{if(!r.allowDragAndDrop||r.disabled())return;s.preventDefault();try{s.dataTransfer&&(s.dataTransfer.dropEffect="copy");}catch{}E(s);(s.dataTransfer?.items??[]).length>0&&o(!0);},f=s=>{!r.allowDragAndDrop||r.disabled()||o(!1);},l=s=>{r.allowDragAndDrop()&&(s.preventDefault(),s.stopPropagation());let g=E(s);if(r.disabled()||!g)return;let x=s.dataTransfer?.files,I=Array.from(x??[]);r.processFiles(I);};return createComponent(a$1,mergeProps({as:"div","aria-label":"dropzone",role:"button",tabindex:"0",get"aria-disabled"(){return r.disabled()},get"data-dragging"(){return t()},ref(s){let g=mergeRefs(r.setDropzoneRef,i.ref);typeof g=="function"&&g(s);},get onClick(){return composeEventHandlers([i.onClick,a])},get onKeyDown(){return composeEventHandlers([i.onKeyDown,n])},get onDragOver(){return composeEventHandlers([i.onDragOver,d])},get onDragLeave(){return composeEventHandlers([i.onDragLeave,f])},get onDrop(){return composeEventHandlers([i.onDrop,l])}},m))}var Ie=template('<input type="file">');function M(e){let[t,o]=splitProps(e,["style","ref","onChange"]),r=c(),i=d(),m=a=>{if(r.disabled())return;let{files:n}=a.currentTarget;r.processFiles(Array.from(n??[]));};return (()=>{let a=Ie(),n=mergeRefs(r.setFileInputRef,t.ref);return typeof n=="function"&&use(n,a),spread(a,mergeProps({get id(){return r.inputId()},get accept(){return r.accept()},get multiple(){return r.multiple()},get style(){return combineStyle({...visuallyHiddenStyles},t.style)},get onChange(){return composeEventHandlers([t.onChange,m])},get required(){return i.isRequired()},get disabled(){return i.isDisabled()},get readOnly(){return i.isReadOnly()}},o),!1,!1),a})()}function B(e){return createComponent(a$1,mergeProps({as:"li"},e))}var $=createContext();function F(){let e=useContext($);if(e===void 0)throw new Error("[kobalte]: `useFileFieldItemContext` must be used within a `FileField.ItemList` component");return e}function H(e){let t=c(),{file:o}=F(),[r,i]=splitProps(e,["onClick"]),m=()=>{t.removeFile(o);};return createComponent(a$2,mergeProps({get onClick(){return composeEventHandlers([r.onClick,m])},get disabled(){return t.disabled()}},i))}function U(e){let t=c(),[o,r]=splitProps(e,["children"]);return createComponent(a$1,mergeProps({as:"ul"},r,{get children(){return createComponent(For,{get each(){return t.acceptedFiles},children:i=>createComponent($.Provider,{value:{file:i},get children(){return o.children(i)}})})}}))}function K(e){let{file:t}=F();return createComponent(a$1,mergeProps({as:"span"},e,{get children(){return e.children??t.name}}))}function L(e){let{file:t}=F(),[o,r]=splitProps(e,["type"]);return createComponent(Show,{get when(){return t.type.match(o.type??".*")},get children(){return createComponent(a$1,mergeProps({as:"div"},r))}})}function q(e){return createComponent(L,{type:"image/*",children:()=>{let[t,o]=createSignal(""),{file:r}=F(),i=(m,a)=>{let n=window,d=n.URL.createObjectURL(m);return a(d),()=>n.URL.revokeObjectURL(d)};return createEffect(()=>{onCleanup(i(r,m=>o(m)));}),createComponent(a$1,mergeProps({as:"img",get src(){return t()}},e))}})}function Ge(e,t,o){if(e===0)return `0 ${o[0]}`;let r=1024,i=Math.floor(Math.log(e)/Math.log(r));return `${Number.parseFloat((e/r**i).toFixed(t))} ${o[i]}`}function G(e){let{translations:t}=c(),o=()=>[t().bytes,t().kb,t().mb,t().gb,t().tb],{file:r}=F(),[i,m]=splitProps(e,["precision"]);return createComponent(a$1,mergeProps({as:"span"},m,{get children(){return Ge(r.size,i.precision??2,o())}}))}function Y(e){let t=c();return createComponent(a$1,mergeProps({as:"label",get for(){return t.inputId()}},e))}var J={bytes:"Bytes",kb:"KB",mb:"MB",gb:"GB",tb:"TB"};function ee(e){let t=`FileField-${createUniqueId()}`,[o,r]=createSignal(),[i,m]=createSignal(),[a,n]=createStore([]),[d,f]=createStore([]),l=mergeDefaultProps({id:t,allowDragAndDrop:!0,disabled:!1,multiple:!1,maxFiles:1,maxFileSize:Number.POSITIVE_INFINITY,minFileSize:0,validate:void 0,translations:J},e),s=v=>{let{acceptedFiles:C,rejectedFiles:u}=N(v,T(l.accept),l.multiple??!1,l.maxFiles??1,l.minFileSize,l.maxFileSize,l.validate);l.multiple?(n(re=>[...re,...C]),f(u)):C.length>0&&C.length===1?(n([C[0]]),f(u)):u.length>0&&u.length===1&&f(u),l.onFileAccept?.(C),u.length>0&&l.onFileReject?.(u),l.onFileChange?.({acceptedFiles:C,rejectedFiles:u});},g=v=>{n(C=>C.filter(u=>u!==v)),l.onFileChange?.({acceptedFiles:unwrap(a),rejectedFiles:unwrap(d)});},[x,I]=splitProps(l,a$3),{formControlContext:h}=b(x),y={inputId:()=>l.id,fileInputRef:o,setFileInputRef:r,dropzoneRef:i,setDropzoneRef:m,disabled:()=>l.disabled,multiple:()=>l.multiple,accept:()=>T(l.accept),allowDragAndDrop:()=>l.allowDragAndDrop,processFiles:s,acceptedFiles:a,rejectedFiles:d,removeFile:g,translations:()=>l.translations};return createComponent(c$1.Provider,{value:h,get children(){return createComponent(P.Provider,{value:y,get children(){return createComponent(a$1,mergeProps({as:"div",role:"group",get id(){return x.id}},()=>h.dataset(),I))}})}})}function te(e){let t=c(),o=d(),[r,i]=splitProps(e,["onClick"]),m=a=>{t.dropzoneRef()?.contains(a.target)&&a.stopPropagation(),t.fileInputRef()?.click();};return createComponent(a$2,mergeProps({get disabled(){return t.disabled()},get onClick(){return composeEventHandlers([r.onClick,m])}},()=>o.dataset(),i))}var oo=Object.assign(ee,{Context:P,Dropzone:j,HiddenInput:M,Label:Y,Trigger:te,ItemList:U,Item:B,ItemPreview:L,ItemPreviewImage:q,ItemSize:G,ItemDeleteTrigger:H,ItemName:K,Description:e,ErrorMessage:a});

export { P as Context, j as Dropzone, oo as FileField, M as HiddenInput, B as Item, H as ItemDeleteTrigger, U as ItemList, K as ItemName, L as ItemPreview, q as ItemPreviewImage, G as ItemSize, Y as Label, ee as Root, te as Trigger, c as useFileFieldContext };
