import{a as V}from"../chunk/27VXZQWW.jsx";import{a as H,b as w,c as z,d as R,e as A}from"../chunk/HIUHMFLS.jsx";import"../chunk/LD6VFCOU.jsx";import{a as D}from"../chunk/3BC6LDRX.jsx";import"../chunk/DOLTULMA.jsx";import{a as F}from"../chunk/HAEWETXL.jsx";import"../chunk/XWCF3RNR.jsx";import{createContext as oe,useContext as te}from"solid-js";var x=oe();function a(){let e=te(x);if(e===void 0)throw new Error("[kobalte]: `useFileFieldContext` must be used within a `FileFieldContext.Root` component");return e}import{createSignal as se,splitProps as pe}from"solid-js";import{composeEventHandlers as E,mergeRefs as me}from"@kobalte/utils";var ie=(e,o)=>{if(e&&o){let i=Array.isArray(o)?o:o.split(","),t=e.name||"",r=(e.type||"").toLowerCase(),p=r.replace(/\/.*$/,"");return i.some(d=>{let l=d.trim().toLowerCase();return l.charAt(0)==="."?t.toLowerCase().endsWith(l):l.endsWith("/*")?p===l.replace(/\/.*$/,""):r===l})}return!0},re=(e,o,i)=>{if(e.size)if(o&&i){if(e.size>i)return[!1,"FILE_TOO_LARGE"];if(e.size<o)return[!1,"FILE_TOO_SMALL"]}else{if(o&&e.size<o)return[!1,"FILE_TOO_SMALL"];if(i&&e.size>i)return[!1,"FILE_TOO_LARGE"]}return[!0,null]},le=(e,o)=>{let i=e.type==="application/x-moz-file"||ie(e,o);return[i,i?null:"FILE_INVALID_TYPE"]},ne=(e,o,i)=>!o&&e>1?!1:e<=i,N=(e,o,i,t,r,p,d)=>{let l=[],P=[];for(let c of e){let[n,s]=le(c,o),[y,T]=re(c,r,p),g=d?.(c),C=g?g.length===0:!0;if(n&&y&&C)l.push(c);else{let L=[s,T];C||L.push(...g??[]),P.push({file:c,errors:L.filter(Boolean)})}}if(!ne(l.length,!!i,t)){for(let c of l)P.push({file:c,errors:["TOO_MANY_FILES"]});l.splice(0)}return{acceptedFiles:l,rejectedFiles:P}},S=e=>e.dataTransfer?e.dataTransfer.types.some(o=>o==="Files"||o==="application/x-moz-file"):!!e.target&&"files"in e.target,h=e=>{if(typeof e=="string")return e;if(Array.isArray(e))return e.join(",")};function J(e){let[o,i]=se(!1),t=a(),[r,p]=pe(e,["ref","onClick","onKeyDown","onDragOver","onDragLeave","onDrop"]),d=s=>{s.target.tagName==="LABEL"?s.stopPropagation():t.fileInputRef()?.click()},l=s=>{s.defaultPrevented||s.key!=="Enter"&&s.key!==" "||t.fileInputRef()?.click()},P=s=>{if(!t.allowDragAndDrop||t.disabled())return;s.preventDefault();try{s.dataTransfer&&(s.dataTransfer.dropEffect="copy")}catch{}let y=S(s);(s.dataTransfer?.items??[]).length>0&&i(!0)},c=s=>{!t.allowDragAndDrop||t.disabled()||i(!1)},n=s=>{t.allowDragAndDrop()&&(s.preventDefault(),s.stopPropagation());let y=S(s);if(t.disabled()||!y)return;let T=s.dataTransfer?.files,g=Array.from(T??[]);t.processFiles(g)};return<F as="div"aria-label="dropzone"role="button"tabindex="0"aria-disabled={t.disabled()}data-dragging={o()}ref={me(t.setDropzoneRef,r.ref)}onClick={E([r.onClick,d])}onKeyDown={E([r.onKeyDown,l])}onDragOver={E([r.onDragOver,P])}onDragLeave={E([r.onDragLeave,c])}onDrop={E([r.onDrop,n])}{...p}/>}import{composeEventHandlers as Fe,mergeRefs as de,visuallyHiddenStyles as ae}from"@kobalte/utils";import{combineStyle as ce}from"@solid-primitives/props";import{splitProps as Pe}from"solid-js";function X(e){let[o,i]=Pe(e,["style","ref","onChange"]),t=a(),r=R(),p=d=>{if(t.disabled())return;let{files:l}=d.currentTarget;t.processFiles(Array.from(l??[]))};return<input type="file"id={t.inputId()}accept={t.accept()}multiple={t.multiple()}ref={de(t.setFileInputRef,o.ref)}style={ce({...ae},o.style)}onChange={Fe([o.onChange,p])}required={r.isRequired()}disabled={r.isDisabled()}readOnly={r.isReadOnly()}{...i}/>}function k(e){return<F as="li"{...e}/>}import{splitProps as ge}from"solid-js";import{composeEventHandlers as ye}from"@kobalte/utils";import{createContext as fe,useContext as Ie}from"solid-js";var M=fe();function I(){let e=Ie(M);if(e===void 0)throw new Error("[kobalte]: `useFileFieldItemContext` must be used within a `FileField.ItemList` component");return e}function j(e){let o=a(),{file:i}=I(),[t,r]=ge(e,["onClick"]),p=()=>{o.removeFile(i)};return<D onClick={ye([t.onClick,p])}disabled={o.disabled()}{...r}/>}import{For as Te,splitProps as Ce}from"solid-js";function _(e){let o=a(),[i,t]=Ce(e,["children"]);return<F as="ul"{...t}><Te each={o.acceptedFiles}>{r=><M.Provider value={{file:r}}>{i.children(r)}</M.Provider>}</Te></F>}function B(e){let{file:o}=I();return<F as="span"{...e}>{e.children??o.name}</F>}import{Show as Ee,splitProps as Le}from"solid-js";function O(e){let{file:o}=I(),[i,t]=Le(e,["type"]);return<Ee when={o.type.match(i.type??".*")}><F as="div"{...t}/></Ee>}import{createEffect as Re,createSignal as ve,onCleanup as De}from"solid-js";function U(e){return<O type="image/*">{()=>{let[o,i]=ve(""),{file:t}=I(),r=(p,d)=>{let l=window,P=l.URL.createObjectURL(p);return d(P),()=>l.URL.revokeObjectURL(P)};return Re(()=>{De(r(t,p=>i(p)))}),<F as="img"src={o()}{...e}/>}}</O>}import{splitProps as Oe}from"solid-js";function be(e,o,i){if(e===0)return`0 ${i[0]}`;let t=1024,r=Math.floor(Math.log(e)/Math.log(t));return`${Number.parseFloat((e/t**r).toFixed(o))} ${i[r]}`}function K(e){let{translations:o}=a(),i=()=>[o().bytes,o().kb,o().mb,o().gb,o().tb],{file:t}=I(),[r,p]=Oe(e,["precision"]);return<F as="span"{...p}>{be(t.size,r.precision??2,i())}</F>}function $(e){let o=a();return<F as="label"for={o.inputId()}{...e}/>}import{createSignal as q,createUniqueId as Se,splitProps as he}from"solid-js";import{mergeDefaultProps as Me}from"@kobalte/utils";import{createStore as G,unwrap as Y}from"solid-js/store";var W={bytes:"Bytes",kb:"KB",mb:"MB",gb:"GB",tb:"TB"};function Q(e){let o=`FileField-${Se()}`,[i,t]=q(),[r,p]=q(),[d,l]=G([]),[P,c]=G([]),n=Me({id:o,allowDragAndDrop:!0,disabled:!1,multiple:!1,maxFiles:1,maxFileSize:Number.POSITIVE_INFINITY,minFileSize:0,validate:void 0,translations:W},e),s=b=>{let{acceptedFiles:u,rejectedFiles:f}=N(b,h(n.accept),n.multiple??!1,n.maxFiles??1,n.minFileSize,n.maxFileSize,n.validate);n.multiple?(l(ee=>[...ee,...u]),c(f)):u.length>0&&u.length===1?(l([u[0]]),c(f)):f.length>0&&f.length===1&&c(f),n.onFileAccept?.(u),f.length>0&&n.onFileReject?.(f),n.onFileChange?.({acceptedFiles:u,rejectedFiles:f})},y=b=>{l(u=>u.filter(f=>f!==b)),n.onFileChange?.({acceptedFiles:Y(d),rejectedFiles:Y(P)})},[T,g]=he(n,H),{formControlContext:C}=w(T),L={inputId:()=>n.id,fileInputRef:i,setFileInputRef:t,dropzoneRef:r,setDropzoneRef:p,disabled:()=>n.disabled,multiple:()=>n.multiple,accept:()=>h(n.accept),allowDragAndDrop:()=>n.allowDragAndDrop,processFiles:s,acceptedFiles:d,rejectedFiles:P,removeFile:y,translations:()=>n.translations};return<z.Provider value={C}><x.Provider value={L}><F as="div"role="group"id={T.id}{...C.dataset()}{...g}/></x.Provider></z.Provider>}import{composeEventHandlers as He}from"@kobalte/utils";import{splitProps as we}from"solid-js";function Z(e){let o=a(),i=R(),[t,r]=we(e,["onClick"]),p=d=>{o.dropzoneRef()?.contains(d.target)&&d.stopPropagation(),o.fileInputRef()?.click()};return<D disabled={o.disabled()}onClick={He([t.onClick,p])}{...i.dataset()}{...r}/>}var nt=Object.assign(Q,{Context:x,Dropzone:J,HiddenInput:X,Label:$,Trigger:Z,ItemList:_,Item:k,ItemPreview:O,ItemPreviewImage:U,ItemSize:K,ItemDeleteTrigger:j,ItemName:B,Description:A,ErrorMessage:V});export{x as Context,A as Description,J as Dropzone,V as ErrorMessage,nt as FileField,X as HiddenInput,k as Item,j as ItemDeleteTrigger,_ as ItemList,B as ItemName,O as ItemPreview,U as ItemPreviewImage,K as ItemSize,$ as Label,Q as Root,Z as Trigger,a as useFileFieldContext};
